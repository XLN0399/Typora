# 分布式计算概念



对数据进行处理，使用统计分析等手段得到需要的结果，多台服务器协同工作，共同完成一个计算任务

常见的两种工作模式：

1. 分散->汇总

   MapReduce

   1. 将数据进行分片，多台服务器各自负责一部分数据处理
   2. 然后将各自的结果，进行汇总处理，得到想要的结果

   <img src="assets/image-20240226194604016.png" alt="image-20240226194604016" style="zoom:67%;" />

2. 中心调度->步骤执行

   大数据体系的Spark，Flink

   1. 由一个节点作为中心调度管理者，将任务划分为几个具体步骤
   2. 管理者安排每个机器执行任务，彼此交换数据，最终得到结果数据

   <img src="assets/image-20240226194916424.png" alt="image-20240226194916424" style="zoom:67%;" />

   




# MapReduce概述



MapReduce是Hadoop内提供的进行分布式计算的组件，属于"分散->汇总"模式的分布式计算框架，提供分布式数据计算

MapReduce提供`Map`和`Reduce`两个编程接口，其中

- `Map`功能接口提供了分散的功能，由服务器分布式对数据进行处理
- `Reduce`功能提供了汇总（聚合）的功能，将分布式的处理结果汇总统计

编程中实现`Map Reduce`功能即可



运行机制

- 将执行的需求分解为多个`Map Task`和`Reduce Task`
- 将`Map Task`和`Reduce Task`分配到对应的服务器去执行



示例：

<img src="assets/image-20240226200012904.png" alt="image-20240226200012904" style="zoom:67%;" />



# YARN概述



MapReduce是基于YARN运行的。YARN是Hadoop内提供的进行分布式资源调度的组件



分布式资源调度是指在一个由多个计算节点组成的分布式系统中，有效地管理和分配系统资源的过程。这些资源可以包括计算资源（如CPU、内存、存储）、网络带宽以及其他相关资源。分布式资源调度的主要目标是确保系统资源得到充分利用，提高系统的性能和可靠性。



YARN管控整个集群的资源进行调度

<img src="assets/image-20240226200517615.png" alt="image-20240226200517615" style="zoom:67%;" />

程序向YARN申请所需资源，YARN为程序分配所需资源提供程序使用

YARN调度资源给MapReduce分配和管理运行资源



# YARN架构



## 核心架构



<img src="assets/image-20240226200755341.png" alt="image-20240226200755341" style="zoom:67%;" />

YARN架构有两个角色：

- 主角色：`ResourceManager`，整个集群的资源调度着，负责协调调度各个程序所需的资源
- 从角色：`NodeManager`，单个服务器的资源调度者，负责调度单个服务器上的资源提供给应用程序使用

<img src="assets/image-20240226201040334.png" alt="image-20240226201040334" style="zoom:67%;" />



## YARN容器



`NodeManager`预先占用一部分资源，然后将这部分资源提供给程序使用，被占用的这部分资源就是容器（Container）

- `NodeManager`会在服务器上构建一个容器（提前占用资源）
- 然后将容器的资源提供给程序使用，程序在运行容器内，无法突破容器的资源限制



## 辅助架构



YARN的架构中除了核心角色`ResourceManager`和`NodeManager`，还可以搭配两个辅助角色

- 代理服务器：Web Application Proxy Web应用代理
- 历史服务器：应用程序历史信息记录服务



### web应用代理

默认请款下，它作为资源管理器（RM）一部分运行，但是可以配置独立模式下运行，使用代理可以减少通过YARN进行基于网络的攻击的可能性

YARN在运行时提供一个Web UI站点，可供用户在浏览器查看YARN的运行信息，对外提供Web站点会有安全性问题，而代理服务器的功能就是最大限度保障对Web UI的访问时安全的

开启代理服务器，可以提供YARN在开放网络中的安全性，但不是绝对安全只能是辅助提高一些



配置独立模式下运行，修改`yarm-site.xml`中`yarn.web-proxy.address`参数即可



### JobHistoryServer历史服务器

记录历史运行的程序信息以及产生的日志并提供Web UI站点供用户使用浏览器查看

将容器中程序运行产生的日志信息，统一收集到HDFS中，然后通过浏览器来查看到所有日志记录，可以保留历史数据，随时查看历史运行程序信息





# MapReduce & YARN 部署







